{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?7e02","webpack:///./src/components/Index.vue?b800","webpack:///./src/components/Export.vue?0d7a","webpack:///./src/App.vue?660b","webpack:///./src/components/Index.vue?1248","webpack:///src/components/Index.vue","webpack:///./src/components/Index.vue?d617","webpack:///./src/components/Index.vue?24bf","webpack:///./src/components/Editor.vue?a61e","webpack:///./src/utils/urls.js","webpack:///./src/utils/maskData.js","webpack:///./src/utils/geometry.js","webpack:///./src/utils/maskHelper.js","webpack:///./src/utils/faceApiUtil.js","webpack:///./src/utils/stickerCanvas.js","webpack:///./src/utils/util.js","webpack:///src/components/Editor.vue","webpack:///./src/components/Editor.vue?145f","webpack:///./src/components/Editor.vue?7a29","webpack:///./src/components/Export.vue?e870","webpack:///src/components/Export.vue","webpack:///./src/components/Export.vue?90b3","webpack:///./src/components/Export.vue?d158","webpack:///./src/components/Share.vue?c538","webpack:///src/components/Share.vue","webpack:///./src/components/Share.vue?b91f","webpack:///./src/components/Share.vue?86f3","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue?bff9","webpack:///./src/store/index.js","webpack:///./src/i18n/lang/en.js","webpack:///./src/i18n/lang/chs.js","webpack:///./src/i18n/index.js","webpack:///./src/main.js","webpack:///./src/assets/example.png","webpack:///./src/components/Editor.vue?31ff","webpack:///./src/components/Share.vue?c6b6"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","style","height","$t","logoPath","_v","directives","rawName","nav","expression","on","navTo","currentFileId","_e","staticRenderFns","ref","_m","staticClass","letterSpacing","_s","wide","domProps","space","width","addImg","methods","inputDOM","files","file","id","Date","getTime","$store","commit","fileInfo","$emit","mounted","$refs","index","clientWidth","component","class","loading","resetMask","_l","maskData","$event","changeMask","baseUrl","reupload","save","maskBaseUrl","modelBaseUrl","assetsBaseUrl","urls","masks","side","leftPoint","rightPoint","bottomPoint","getMidPoint","p1","p2","x1","y1","x2","y2","makeLine","pointDistance","Math","sqrt","pointLineDistance","x","y","A","B","C","abs","makePerpendicularLine","getCrossPointOfTwoLines","l1","l2","A1","B1","C1","A2","B2","C2","denominator","getPerpendicularPoint","getAngle","center","sp","ep","cx","cy","sx","sy","ex","ey","f_c_x","f_c_y","s_c_x","s_c_y","angle","acos","vecX","vecY","PI","cvt","maskImageSrc","findMask","lp","rp","bp","minDistance","Number","MAX_VALUE","minData","filter","forEach","dm12","geometry","dm13","dm03","dm01","rate","x0","y0","pline","assign","overturn","transform","computeTransform","sp1","sp2","sp3","ep1","ep2","ep3","stickerWidth","stickerHeight","de12","xScale","yScale","centerX","centerY","sign","wearAMaskAfterFaceDetection","canvasModel","realImgInfo","points","landmarks","positions","nosePoint","maskInfo","mask","imgOriginalWidth","detection","imageWidth","imgOriginalHeight","imageHeight","wearAMaskNormally","xRate","yRate","getMaskImageSrc","url","layers","removeItem","addPhoto","position","chooseItem","wearAMaskAsAFool","newMask","oldRect","rect","callback","self","xhr","XMLHttpRequest","onload","URL","createObjectURL","response","open","responseType","send","modelUrl","modelsLoaded","modelsLoading","onModelsLoaded","onModelsLoadErr","loadModels","failed","onLoadErr","Promise","all","faceapi","faceLandmark68Net","loadFromUri","catch","ssdMobilenetv1","then","detectPic","img","onFailed","process","options","minConfidence","withFaceLandmarks","console","log","maskHelper","processOnFailed","drawFaceLandmarks","canvas","ctx","getContext","e","fillStyle","fillRect","font","fillText","getVectorLength","v1","v2","getDocPosition","element","eleCom","document","querySelector","offsetLeft","offsetTop","parent","offsetParent","Border","cPoints","reduce","a","b","rPoint","draw","context","c_x","c_y","translate","rotate","beginPath","globalAlpha","lineWidth","strokeStyle","moveTo","lineTo","stroke","closePath","pointList","concat","item","arc","fill","restore","point","status","r_point","rotatePoint","d_point","map","c_point","pow","Rect","getPoints","h","w","vector","_x","_y","getCenter","parseFloat","_angle","_x_x","sin","_y_x","cos","n_x","_x_y","_y_y","n_y","tan","atan","pointZoom","_angles","n_tan","p3","p4","ratio1","ratio2","Photo","image","canEdit","orientation","imgInput","onLoad","isLoad","Image","prepare","init","src","complete","scale","drawImage","StickerCanvas","target","beforeLoading","afterLoading","getElementById","loadingLayerCount","border","current","initEvent","clear","add","lyr","setTimeout","addEventListener","p_x","pageX","p_y","pageY","offsetWidth","selectPhoto","move","event","m_x","m_y","e_point","isNaN","zoom","removeEventListener","preventDefault","touches","command","rectOptions","isPointInSkeletion","reverse","c_index","isPointInRect","createElement","bg","xOffset","yOffset","fg","toDataURL","setTransform","clearRect","refresh","cen","first","second","shareImageSrc","getShareImageSrc","filename","imgContain","cw","ch","iw","ih","setRate","imgWidth","imgHeight","imgX","imgY","imgCover","props","fileId","editor","loadImg","remove","clientHeight","maskStore","control","canvasContainer","appendChild","reader","readAsDataURL","rimg","export","faceApiUtil","watch","v","state","userImgInfo","imgUrl","onImgLoaded","share","backToEditor","backToIndex","imgStyle","computed","created","left","top","back","finishImg","util","simg","sUrl","xBlank","yBlank","components","Index","Editor","Export","Share","where","title","Vue","use","Vuex","getters","actions","mutations","setUserImgInfo","setEditor","setFinishImg","Store","language","logo","text","slogan","text1","text2","selectImg","description","reset","reselectImg","saveImg","shareImg","p0","VueI18n","i18n","locale","messages","en","chs","config","productionTip","store","render","App","$mount"],"mappings":"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","file":"js/app.4b8ad7ed.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/wear-a-mask/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=style&index=0&id=0b7cc33c&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=style&index=0&id=0b7cc33c&scoped=true&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Export.vue?vue&type=style&index=0&id=20cc60b4&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Export.vue?vue&type=style&index=0&id=20cc60b4&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{style:({height: _vm.$t('logo.height') + 'vh'}),attrs:{\"id\":\"header\"}},[_c('img',{attrs:{\"id\":\"logo\",\"src\":_vm.logoPath}}),_c('a',{attrs:{\"id\":\"forkMe\",\"href\":\"https://github.com/zamhown/wear-a-mask\"}},[_vm._v(\"Fork me on GitHub!\")])]),_c('div',{style:({height: 100 - _vm.$t('logo.height') + 'vh'}),attrs:{\"id\":\"contentContainer\"}},[_c('div',{attrs:{\"id\":\"content\"}},[_c('Index',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.nav=='index'),expression:\"nav=='index'\"}],on:{\"navTo\":_vm.navTo}}),_c('Editor',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.nav=='editor'),expression:\"nav=='editor'\"}],attrs:{\"fileId\":_vm.currentFileId},on:{\"navTo\":_vm.navTo}}),(_vm.nav=='export')?_c('Export',{on:{\"navTo\":_vm.navTo}}):_vm._e(),(_vm.nav=='share')?_c('Share',{on:{\"navTo\":_vm.navTo}}):_vm._e()],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"index\"},[_vm._m(0),_c('p',{staticClass:\"title\",style:({letterSpacing: _vm.$t('index.title.letterSpacing')})},[_vm._v(_vm._s(_vm.$t('index.title.text')))]),_c('p',{staticClass:\"slogan\",style:({letterSpacing: _vm.$t('index.slogan.letterSpacing')})},[(!_vm.wide)?_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.space)}}):_vm._e(),_vm._v(_vm._s(_vm.$t('index.slogan.text1'))),(!_vm.wide)?_c('br'):_vm._e(),(!_vm.wide)?_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.space)}}):_vm._e(),_vm._v(_vm._s(_vm.$t('index.slogan.text2')))]),_c('div',{staticClass:\"upload\",style:({width: _vm.$t('index.selectImg.width')})},[_c('span',[_vm._v(_vm._s(_vm.$t('index.selectImg.text')))]),_c('input',{ref:\"inputer\",staticClass:\"upload\",attrs:{\"type\":\"file\",\"accept\":\"image/*\"},on:{\"change\":_vm.addImg}})]),_c('p',{staticClass:\"description\",style:({letterSpacing: _vm.$t('index.description.letterSpacing')})},[_vm._v(_vm._s(_vm.$t('index.description.text1')))]),_c('p',{staticClass:\"description\",style:({letterSpacing: _vm.$t('index.description.letterSpacing')})},[_vm._v(_vm._s(_vm.$t('index.description.text2')))])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_c('img',{staticClass:\"example\",attrs:{\"src\":require(\"../assets/example.png\")}})])}]\n\nexport { render, staticRenderFns }","<template>\n  <div ref=\"index\">\n    <p><img class=\"example\" src=\"../assets/example.png\"></p>\n    <p class=\"title\" :style=\"{letterSpacing: $t('index.title.letterSpacing')}\">{{ $t('index.title.text') }}</p>\n    <p class=\"slogan\" :style=\"{letterSpacing: $t('index.slogan.letterSpacing')}\"><span v-if=\"!wide\" v-html=\"space\"></span>{{ $t('index.slogan.text1') }}<br v-if=\"!wide\"><span v-if=\"!wide\" v-html=\"space\"></span>{{ $t('index.slogan.text2') }}</p>\n    <div class=\"upload\" :style=\"{width: $t('index.selectImg.width')}\">\n      <span>{{ $t('index.selectImg.text') }}</span>\n      <input type=\"file\" class=\"upload\" @change=\"addImg\" ref=\"inputer\" accept=\"image/*\" />\n    </div>\n    <p class=\"description\" :style=\"{letterSpacing: $t('index.description.letterSpacing')}\">{{ $t('index.description.text1') }}</p>\n    <p class=\"description\" :style=\"{letterSpacing: $t('index.description.letterSpacing')}\">{{ $t('index.description.text2') }}</p>\n  </div>\n</template>\n\n<script>\n/* eslint-disable no-console */\n\nexport default {\n  data() {\n    return {\n      space: this.$t('index.slogan.space'),\n      wide: false\n    }\n  },\n  methods: {\n    addImg() {\n      let inputDOM = this.$refs.inputer;\n      // 通过DOM取文件数据\n      if (inputDOM.files.length == 1) {\n        /*\n        let size = Math.floor(inputDOM.files[0].size / 1024);\n        if (size > 5 * 1024 * 1024) {\n          alert('请选择5M以内的图片！');\n          return false;\n        }\n        */\n        const fileInfo = {\n          file: inputDOM.files[0],\n          id: new Date().getTime()\n        };\n        this.$store.commit('setUserImgInfo', fileInfo);\n        this.$emit('navTo', 'editor', fileInfo.id);\n      }\n    }\n  },\n  mounted () {\n    this.wide = this.$refs.index.clientWidth > 500;\n  }\n}\n</script>\n\n<style scoped>\n.example {\n  width: 100%;\n  max-width: 400px;\n}\n.title {\n  font-size: 20px;\n  font-weight: bolder;\n  line-height: 35px;\n  color: #ff664d;\n}\n.slogan {\n  font-size: 18px;\n  line-height: 28px;\n  color: #ff8571;\n}\n.description {\n  color: #888;\n  margin: 0px 15px 15px 15px;\n  text-align: justify;\n}\n.upload {\n  position: relative;\n  height: 60px;\n  margin: 20px auto;\n  background: #ff8571;\n  border-radius: 30px;\n  font-size: 16px;\n  box-shadow: 0px 0px 10px #ccc;\n}\n.upload:hover {\n  background: #ff664d;\n}\n.upload span{\n  display: block;\n  width: 100%;\n  height: 100%;\n  color: white;\n  font-size: 20px;\n  line-height: 60px;\n}\n.upload input {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin: 0px;\n  width: 160px;\n  height: 60px;\n  opacity: 0;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=0b7cc33c&scoped=true&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Index.vue?vue&type=style&index=0&id=0b7cc33c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0b7cc33c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"editor\",attrs:{\"id\":\"editor\"}},[_c('div',{class:{'loading': _vm.loading},attrs:{\"id\":\"editorUI\"}},[_c('div',{ref:\"canvasContainer\"}),_c('button',{style:({width: _vm.$t('editor.reset.width')}),attrs:{\"id\":\"resetBtn\"},on:{\"click\":_vm.resetMask}},[_vm._v(_vm._s(_vm.$t('editor.reset.text')))]),_c('div',{ref:\"maskStore\",attrs:{\"id\":\"maskStore\"}},[_c('p',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.$t('editor.changeMask')))]),_c('div',{staticClass:\"list\"},[_c('ul',_vm._l((_vm.maskData.masks),function(m){return _c('li',{key:m.name,on:{\"click\":function($event){return _vm.changeMask(m)}}},[_c('img',{attrs:{\"src\":_vm.maskData.baseUrl + m.name}})])}),0)])]),_c('div',{ref:\"control\",staticClass:\"control\"},[_c('button',{style:({width: _vm.$t('editor.reselectImg.width')}),attrs:{\"id\":\"reuploadBtn\"},on:{\"click\":_vm.reupload}},[_vm._v(_vm._s(_vm.$t('editor.reselectImg.text')))]),_c('button',{style:({width: _vm.$t('editor.saveImg.width')}),attrs:{\"id\":\"saveBtn\"},on:{\"click\":_vm.save}},[_vm._v(_vm._s(_vm.$t('editor.saveImg.text')))])])]),(_vm.loading)?_c('div',{attrs:{\"id\":\"loading\"}},[_c('div',{style:({width: _vm.$t('editor.loading.width'), height: _vm.$t('editor.loading.height')})},[_c('p',[_c('b',[_vm._v(_vm._s(_vm.$t('editor.loading.title')))]),_c('br'),_vm._v(\" \"+_vm._s(_vm.$t('editor.loading.text1'))+\" \"),_c('br'),_vm._v(\" \"+_vm._s(_vm.$t('editor.loading.text2'))+\" \")])])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default {\r\n    maskBaseUrl: 'https://zamhown.github.io/wear-a-mask/masks/',\r\n    modelBaseUrl: 'https://zamhown.github.io/wear-a-mask/weights/',\r\n    assetsBaseUrl: 'https://zamhown.github.io/wear-a-mask/assets/'\r\n}","import urls from './urls';\r\n\r\nexport default {\r\n    baseUrl: urls.maskBaseUrl,\r\n    // 数据要求：leftPoint和rightPoint必须同高\r\n    // side：0正面，1左侧面，2右侧面\r\n    masks: [\r\n        {\r\n            name: \"n1.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [4, 90],\r\n            rightPoint: [248, 90],\r\n            bottomPoint: [130, 216]\r\n        },\r\n        {\r\n            name: \"n2.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [3, 71],\r\n            rightPoint: [255, 71],\r\n            bottomPoint: [129, 231]\r\n        },\r\n        {\r\n            name: \"n3.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [6, 81],\r\n            rightPoint: [249, 81],\r\n            bottomPoint: [131, 246]\r\n        },\r\n        {\r\n            name: \"n4.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [4, 69],\r\n            rightPoint: [252, 69],\r\n            bottomPoint: [137, 234]\r\n        },\r\n        {\r\n            name: \"n5.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [13, 47],\r\n            rightPoint: [248, 47],\r\n            bottomPoint: [163, 222]\r\n        },\r\n        {\r\n            name: \"n6.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [7, 56],\r\n            rightPoint: [251, 56],\r\n            bottomPoint: [108, 243]\r\n        },\r\n        {\r\n            name: \"n7.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [7, 78],\r\n            rightPoint: [247, 78],\r\n            bottomPoint: [123, 230]\r\n        },\r\n        {\r\n            name: \"n8.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [17, 77],\r\n            rightPoint: [248, 77],\r\n            bottomPoint: [131, 250]\r\n        },\r\n        {\r\n            name: \"n9.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [61, 156],\r\n            rightPoint: [223, 156],\r\n            bottomPoint: [137, 247]\r\n        },\r\n        {\r\n            name: \"n10.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 1,\r\n            leftPoint: [8, 100],\r\n            rightPoint: [225, 100],\r\n            bottomPoint: [92, 240]\r\n        },\r\n        {\r\n            name: \"n11.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 1,\r\n            leftPoint: [37, 86],\r\n            rightPoint: [221, 86],\r\n            bottomPoint: [80, 243]  // 假点，为了避免戴在正脸上\r\n        },\r\n        {\r\n            name: \"n12.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [8, 65],\r\n            rightPoint: [250, 65],\r\n            bottomPoint: [127, 242]\r\n        },\r\n        {\r\n            name: \"n13.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [10, 86],\r\n            rightPoint: [249, 86],\r\n            bottomPoint: [126, 244]\r\n        },\r\n        {\r\n            name: \"n14.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [10, 97],\r\n            rightPoint: [246, 97],\r\n            bottomPoint: [122, 210]\r\n        },\r\n        {\r\n            name: \"n15.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 2,\r\n            leftPoint: [3, 63],\r\n            rightPoint: [209, 63],\r\n            bottomPoint: [143, 241]\r\n        },\r\n        {\r\n            name: \"n16.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [11, 88],\r\n            rightPoint: [240, 88],\r\n            bottomPoint: [123, 210]\r\n        },\r\n        {\r\n            name: \"n17.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [9, 59],\r\n            rightPoint: [236, 59],\r\n            bottomPoint: [95, 248]\r\n        },\r\n        {\r\n            name: \"n18.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [13, 93],\r\n            rightPoint: [244, 93],\r\n            bottomPoint: [133, 226]\r\n        },\r\n        {\r\n            name: \"n19.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [15, 45],\r\n            rightPoint: [247, 45],\r\n            bottomPoint: [165, 247]\r\n        },\r\n        {\r\n            name: \"n20.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [8, 77],\r\n            rightPoint: [246, 77],\r\n            bottomPoint: [127, 242]\r\n        },\r\n        {\r\n            name: \"n21.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [11, 65],\r\n            rightPoint: [246, 65],\r\n            bottomPoint: [129, 251]\r\n        },\r\n        {\r\n            name: \"n22.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [31, 107],\r\n            rightPoint: [215, 107],\r\n            bottomPoint: [123, 232]\r\n        },\r\n        {\r\n            name: \"n23.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [19, 93],\r\n            rightPoint: [239, 93],\r\n            bottomPoint: [125, 232]\r\n        },\r\n        {\r\n            name: \"n24.png\",\r\n            width: 256,\r\n            height: 256,\r\n            side: 0,\r\n            leftPoint: [19, 72],\r\n            rightPoint: [242, 72],\r\n            bottomPoint: [154, 251]\r\n        },\r\n    ]\r\n};","export default {\r\n    // 求两点的中点\r\n    getMidPoint(p1, p2) {\r\n        const [x1, y1] = p1;\r\n        const [x2, y2] = p2;\r\n        return [(x1 + x2) / 2, (y1 + y2) / 2];\r\n    },\r\n    // 已知两点求直线解析式Ax+By+C=0\r\n    makeLine(p1, p2) {\r\n        const [x1, y1] = p1;\r\n        const [x2, y2] = p2;\r\n        return [\r\n            y1 - y2,\r\n            x2 - x1,\r\n            (x1 - x2) * y2 + (y2 - y1) * x2\r\n        ];\r\n    },\r\n    // 两点距离\r\n    pointDistance(p1, p2) {\r\n        const [x1, y1] = p1;\r\n        const [x2, y2] = p2;\r\n        return Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\r\n    },\r\n    // 已知一点和直线解析式Ax+By+C=0，求点到直线的距离\r\n    pointLineDistance(p, l) {\r\n        const [x, y] = p;\r\n        const [A, B, C] = l;\r\n        return Math.abs(A * x + B * y + C) / Math.sqrt(A * A + B * B);\r\n    },\r\n    // 已知直线解析式Ax+By+C=0和垂线上一点，求过该点的垂线的解析式\r\n    makePerpendicularLine(l, p) {\r\n        const [A, B] = l;\r\n        const [x, y] = p;\r\n        return [\r\n            -B,\r\n            A,\r\n            B * x - A * y\r\n        ];\r\n    },\r\n    // 求两直线的交点\r\n    getCrossPointOfTwoLines(l1, l2) {\r\n        const [A1, B1, C1] = l1;\r\n        const [A2, B2, C2] = l2;\r\n        const denominator = A1 * B2 - A2 * B1;\r\n        return [(B1 * C2 - B2 * C1) / denominator,\r\n            (A2 * C1 - A1 * C2) / denominator];\r\n    },\r\n    // 已知一点和直线解析式Ax+By+C=0，求点到直线的垂线与直线的交点\r\n    getPerpendicularPoint(l, p) {\r\n        return this.getCrossPointOfTwoLines(l, this.makePerpendicularLine(l, p));\r\n    },\r\n    // 根据旋转中心点和一点的初、末坐标，求旋转角度\r\n    getAngle(center, sp, ep) {\r\n        const [cx, cy] = center;\r\n        const [sx, sy] = sp;\r\n        const [ex, ey] = ep;\r\n        const f_c_x = sx - cx;\r\n        const f_c_y = cy - sy;\r\n        const s_c_x = ex - cx;\r\n        const s_c_y = cy - ey;\r\n        const c = Math.sqrt(f_c_x * f_c_x + f_c_y * f_c_y)\r\n            * Math.sqrt(s_c_x * s_c_x + s_c_y * s_c_y);\r\n        if (c === 0) return -1;\r\n        const angle = Math.acos((f_c_x * s_c_x + f_c_y * s_c_y) / c);\r\n        const [vecX, vecY] = [cx - ex, cy - ey];\r\n        // 第一象限\r\n        if (vecX < 0 && vecY < 0) {\r\n            return angle;\r\n        }\r\n        // 第二象限\r\n        if (vecX < 0 && vecY > 0) {\r\n            return angle;\r\n        }\r\n        // 第三象限\r\n        if (vecX > 0 && vecY < 0) {\r\n            return 2 * Math.PI - angle;\r\n        }\r\n        // 第四象限\r\n        if (vecX > 0 && vecY > 0) {\r\n            return 2 * Math.PI - angle;\r\n        }\r\n        return null;\r\n    }\r\n}","/* eslint-disable no-console */\r\nimport maskData from \"./maskData\";\r\nimport geometry from \"./geometry\";\r\nimport { Object } from \"core-js\";\r\n\r\nfunction cvt(p) {\r\n    return [p.x, p.y];\r\n}\r\n\r\nexport default {\r\n    // 口罩图像缓存\r\n    maskImageSrc: {},\r\n    // 挑选合适的口罩\r\n    findMask(lp, rp, bp, side) {\r\n        // 将口罩放缩，左右两点和脸部左右两点重合，计算底部点的距离\r\n        let minDistance = Number.MAX_VALUE;\r\n        let minData = null;\r\n        maskData.masks.filter(m => (m.side == 0 && side == 0) || m.side * side > 0).forEach(m => {\r\n            const dm12 = geometry.pointDistance(m.leftPoint, m.rightPoint);\r\n            const dm13 = geometry.pointDistance(m.leftPoint, m.bottomPoint);\r\n            const dm03 = geometry.pointLineDistance(m.bottomPoint, geometry.makeLine(m.leftPoint, m.rightPoint));\r\n            const dm01 = Math.sqrt(dm13 * dm13 - dm03 * dm03);\r\n            const rate = dm01 / dm12;\r\n            const [x1, y1] = lp;\r\n            const [x2, y2] = rp;\r\n            // 正常\r\n            if ((m.side == 0 && side == 0) || m.side == side) {\r\n                let [x0, y0] = [x1 + (x2 - x1) * rate, y1 + (y2 - y1) * rate];\r\n                let pline = geometry.makePerpendicularLine(geometry.makeLine(lp, rp), [x0, y0]);\r\n                let d = geometry.pointLineDistance(bp, pline);\r\n                if (minDistance > d) {\r\n                    minDistance = d;\r\n                    minData = Object.assign({\r\n                        overturn: false,\r\n                        transform: this.computeTransform(\r\n                            m.leftPoint, m.rightPoint, m.bottomPoint,\r\n                            lp, rp, geometry.getPerpendicularPoint(pline, bp),\r\n                            m.width, m.height)\r\n                    }, m);\r\n                }\r\n            }\r\n            // 翻转\r\n            if ((m.side == 0 && side == 0) || m.side != side) {\r\n                let [x0, y0] = [x2 + (x1 - x2) * rate, y2 + (y1 - y2) * rate];\r\n                let pline = geometry.makePerpendicularLine(geometry.makeLine(lp, rp), [x0, y0]);\r\n                let d = geometry.pointLineDistance(bp, pline);\r\n                if (minDistance > d) {\r\n                    minDistance = d;\r\n                    minData = Object.assign({\r\n                        overturn: true,\r\n                        transform: this.computeTransform(\r\n                            [m.width - m.leftPoint[0], m.leftPoint[1]], [m.width - m.rightPoint[0], m.rightPoint[1]], [m.width - m.bottomPoint[0], m.bottomPoint[1]],\r\n                            lp, rp, geometry.getPerpendicularPoint(pline, bp),\r\n                            m.width, m.height)\r\n                    }, m);\r\n                }\r\n            }\r\n        });\r\n        return minData;\r\n    },\r\n    // 通过三点的起始坐标和终止坐标，计算平移、缩放和旋转（前提：sp1和sp2同高）\r\n    computeTransform(sp1, sp2, sp3, ep1, ep2, ep3, stickerWidth, stickerHeight) {\r\n        const de12 = geometry.pointDistance(ep1, ep2);\r\n        const xScale = de12 / geometry.pointDistance(sp1, sp2);\r\n        const yScale = geometry.pointLineDistance(ep3, geometry.makeLine(ep1, ep2)) / geometry.pointLineDistance(sp3, geometry.makeLine(sp1, sp2));\r\n        return {\r\n            xScale: xScale,\r\n            yScale: yScale,\r\n            centerX: (stickerWidth / 2 - sp1[0]) * xScale + ep1[0],\r\n            centerY: (stickerHeight / 2 - sp1[1]) * xScale + ep1[1],\r\n            angle: geometry.getAngle(ep1,\r\n                [ep1[0] + de12 * Math.sign(ep2[0] - ep1[0]), ep1[1]],\r\n                ep2)\r\n        }\r\n    },\r\n    // 戴口罩\r\n    wearAMaskAfterFaceDetection(result, canvasModel, realImgInfo) {\r\n        const points = result.landmarks.positions;\r\n        let leftPoint = geometry.getMidPoint(cvt(points[1]), cvt(points[2]));  // 左边缘\r\n        let rightPoint = geometry.getMidPoint(cvt(points[15]), cvt(points[14]));  // 右边缘\r\n        const bottomPoint = cvt(points[8]);  // 下边缘\r\n        const nosePoint = cvt(points[28]);  // 鼻\r\n        let side = 0;\r\n        // 判断鼻是否超过左右点\r\n        if (nosePoint.x > rightPoint.x) {\r\n            rightPoint = nosePoint;\r\n            side = 2;\r\n        } else if (nosePoint.x < leftPoint.x) {\r\n            leftPoint = nosePoint;\r\n            side = 1;\r\n        }\r\n        // 查找口罩\r\n        const maskInfo = {\r\n            mask: this.findMask(leftPoint, rightPoint, bottomPoint, side),\r\n            imgOriginalWidth: result.detection.imageWidth,\r\n            imgOriginalHeight: result.detection.imageHeight\r\n        }\r\n        return this.wearAMaskNormally(maskInfo, canvasModel, realImgInfo);\r\n    },\r\n    // 正常地戴口罩\r\n    wearAMaskNormally(maskInfo, canvasModel, realImgInfo) {\r\n        const mask = maskInfo.mask;\r\n        const xRate = realImgInfo.width / maskInfo.imgOriginalWidth;\r\n        const yRate = realImgInfo.height / maskInfo.imgOriginalHeight;\r\n        const stickerWidth = mask.width * mask.transform.xScale * (mask.overturn ? -1 : 1) * xRate;\r\n        this.getMaskImageSrc(mask, url => {\r\n            if (canvasModel.layers.length > 1) {\r\n                canvasModel.removeItem(1);\r\n            }\r\n            canvasModel.addPhoto(url, {\r\n                width: stickerWidth,\r\n                height: mask.height * mask.transform.yScale * yRate,\r\n                centerX: mask.transform.centerX * xRate + realImgInfo.position[0] - (mask.overturn ? stickerWidth : 0),\r\n                centerY: mask.transform.centerY * yRate + realImgInfo.position[1],\r\n                angle: mask.transform.angle\r\n            }, true);\r\n            canvasModel.chooseItem(1);\r\n        });\r\n        return maskInfo;\r\n    },\r\n    // 笨拙地戴口罩\r\n    wearAMaskAsAFool(canvasModel, realImgInfo) {\r\n        const mask = maskData.masks[2];\r\n        this.getMaskImageSrc(mask, url => {\r\n            if (canvasModel.layers.length > 1) {\r\n                canvasModel.removeItem(1);\r\n            }\r\n            canvasModel.addPhoto(url, {\r\n                width: realImgInfo.width / 4,\r\n                height: realImgInfo.height / 4,\r\n                centerX: canvasModel.width / 2,\r\n                centerY: canvasModel.height / 2,\r\n                angle: 0\r\n            }, true);\r\n            canvasModel.chooseItem(1);\r\n        });\r\n        return { mask };\r\n    },\r\n    // 重新戴口罩\r\n    resetMask(maskInfo, canvasModel, realImgInfo) {\r\n        if (maskInfo.imgOriginalWidth) {\r\n            this.wearAMaskNormally(maskInfo, canvasModel, realImgInfo);\r\n        } else {\r\n            this.wearAMaskAsAFool(canvasModel, realImgInfo);\r\n        }\r\n    },\r\n    // 更换口罩\r\n    changeMask(newMask, canvasModel) {\r\n        const oldRect = canvasModel.layers[1].rect;\r\n        canvasModel.removeItem(1);\r\n        this.getMaskImageSrc(newMask, url => {\r\n            canvasModel.addPhoto(url, {\r\n                width: oldRect.width,\r\n                height: oldRect.height,\r\n                centerX: oldRect.center[0],\r\n                centerY: oldRect.center[1],\r\n                angle: oldRect.angle\r\n            }, true);\r\n            canvasModel.chooseItem(1);\r\n        });\r\n    },\r\n    // ajax获取口罩图片（防止canvas导出时报跨域的错）\r\n    getMaskImageSrc(mask, callback) {\r\n        if (this.maskImageSrc[mask.name]) {\r\n            callback(this.maskImageSrc[mask.name]);\r\n        } else {\r\n            const self = this;\r\n            const xhr = new XMLHttpRequest();\r\n            xhr.onload = function () {\r\n                const url = URL.createObjectURL(this.response);\r\n                self.maskImageSrc[mask.name] = url;\r\n                callback(url);\r\n            };\r\n            xhr.open('GET', maskData.baseUrl + mask.name, true);\r\n            xhr.responseType = 'blob';\r\n            xhr.send();\r\n        }\r\n    }\r\n}\r\n\r\n","/* eslint-disable no-console */\r\nimport * as faceapi from 'face-api.js';\r\nimport maskHelper from './maskHelper';\r\nimport urls from './urls';\r\n\r\nconst modelUrl = urls.modelBaseUrl;\r\n\r\nexport default {\r\n  modelsLoaded: false,\r\n  modelsLoading: false,\r\n  onModelsLoaded: null,\r\n  onModelsLoadErr: null,\r\n  loadModels () {\r\n    if (this.modelsLoading || this.modelsLoaded) {\r\n      return;\r\n    }\r\n    let failed = false;\r\n    const onLoadErr = () => { failed = true; };\r\n    \r\n    this.modelsLoading = true;\r\n    // 加载训练好的模型(weight，bias)\r\n    // faceLandmark68Net 识别脸部特征用于mobilenet算法\r\n    // faceLandmark68TinyNet 识别脸部特征用于tiny算法\r\n    // ssdMobilenetv1 google开源AI算法除库包含分类和线性回归\r\n    // tinyFaceDetector 比Google的mobilenet更轻量级，速度更快一点\r\n    // mtcnn  多任务CNN算法\r\n    Promise.all([\r\n      faceapi.nets.faceLandmark68Net.loadFromUri(modelUrl).catch(onLoadErr),\r\n      faceapi.nets.faceLandmark68Net.loadFromUri(modelUrl).catch(onLoadErr),\r\n      //faceapi.nets.faceLandmark68TinyNet.loadFromUri(modelUrl).catch(onLoadErr),\r\n      faceapi.nets.ssdMobilenetv1.loadFromUri(modelUrl).catch(onLoadErr),\r\n      //faceapi.nets.tinyFaceDetector.loadFromUri(modelUrl).catch(onLoadErr),\r\n      //faceapi.nets.mtcnn.loadFromUri(modelUrl).catch(onLoadErr)\r\n    ]).then(async () => {\r\n      this.modelsLoading = false;\r\n      this.modelsLoaded = !failed;\r\n      if (!failed && this.onModelsLoaded) {\r\n        this.onModelsLoaded();\r\n        this.onModelsLoaded = null;\r\n      } else if (failed && this.onModelsLoadErr) {\r\n        this.onModelsLoadErr();\r\n        this.onModelsLoadErr = null;\r\n      }\r\n    });\r\n  },\r\n  detectPic(img, canvasModel, realImgInfo, callback, onFailed) {\r\n    const process = async () => {\r\n      //设置需要使用什么算法和参数进行扫描识别图片的人脸特征\r\n      const options = new faceapi.SsdMobilenetv1Options({ minConfidence: 0.2 })\r\n      //const options = new faceapi.TinyFaceDetectorOptions({ inputSize: 160, scoreThreshold: 0.3})\r\n      //const options = new faceapi.MtcnnOptions()\r\n      let result = await faceapi.detectSingleFace(img, options).withFaceLandmarks()\r\n      console.log(result)\r\n      if (result) {\r\n        let maskInfo = maskHelper.wearAMaskAfterFaceDetection(result, canvasModel, realImgInfo);\r\n        // this.drawFaceLandmarks(canvasModel.canvas, [result], realImgInfo)\r\n        if (callback) {\r\n          callback(maskInfo);\r\n        }\r\n      } else if (onFailed) { onFailed('no result'); }\r\n    }\r\n    const processOnFailed = () => { if (onFailed) { onFailed('no result'); } };\r\n\r\n    if (this.modelsLoading) {\r\n      this.onModelsLoaded = process;\r\n      this.onModelsLoadErr = processOnFailed;\r\n    } else if (!this.modelsLoaded) {\r\n      this.onModelsLoaded = process;\r\n      this.onModelsLoadErr = processOnFailed;\r\n      this.loadModels();\r\n    } else {\r\n      process();\r\n    }\r\n  },\r\n  drawFaceLandmarks(canvas, result, realImgInfo) {\r\n    let ctx = canvas.getContext(\"2d\");\r\n    result.forEach(e => {\r\n      let xRate = realImgInfo.width / e.detection.imageWidth;\r\n      let yRate = realImgInfo.height / e.detection.imageHeight;\r\n      e.landmarks.positions.forEach((e, i) => {\r\n        let x = e.x * xRate + realImgInfo.position[0];\r\n        let y = e.y * yRate + realImgInfo.position[1];\r\n        ctx.fillStyle=\"#0000FF\";\r\n        ctx.fillRect(x - 2, y - 2, 4, 4);\r\n        ctx.font = \"12px bold 宋体\";\r\n        ctx.fillText(i, x, y);\r\n      });\r\n    });\r\n  }\r\n}","/* eslint-disable no-console */\n\nconst getVectorLength = (v1, v2) => {\n    const [x1, y1] = v1;\n    const [x2, y2] = v2;\n    return (x1 * x2 + y1 * y2) / Math.sqrt(x1 * x1 + y1 * y1);\n};\n\nconst getDocPosition = (element) => {\n    let eleCom = element;\n    if (typeof element === 'string') eleCom = document.querySelector(eleCom);\n    let x = eleCom.offsetLeft;\n    let y = eleCom.offsetTop;\n    let parent = eleCom.offsetParent;\n    while (parent) {\n        x += parent.offsetLeft;\n        y += parent.offsetTop;\n        parent = parent.offsetParent;\n    }\n    return {\n        x,\n        y,\n    };\n};\n\n// 图片边框类\nclass Border {\n    /*\n    成员：\n    canvas  画布\n    rect  Rect对象，边框大小和位置\n    points  边框的四个顶点（左上角点、右上角点、右下角点、左下角点）\n    cPoints  边框的四个中点（左、上、右、下）\n    rPoint  边框的旋转点\n    */\n    constructor(canvas) {\n        this.canvas = canvas;\n    }\n    refresh(rect) {\n        this.rect = rect;\n        this.points = this.rect.points;\n        // 中点\n        this.cPoints = [];\n        this.points.reduce((a, b) => {\n            this.cPoints.push([(a[0] + b[0]) / 2, (a[1] + b[1]) / 2]);\n            return b;\n        }, this.points[3]);\n        // 旋转点\n        if (rect.height >= 0) {\n            this.rPoint = [(this.points[0][0] + this.points[1][0]) / 2,\n                this.points[0][1] - 35];\n        } else {\n            this.rPoint = [(this.points[2][0] + this.points[3][0]) / 2,\n                this.points[0][1] + 35];\n        }\n        this.draw();\n    }\n    draw() {\n        const {\n            points,\n            center,\n            angle,\n            width,\n            height,\n        } = this.rect;\n        const { context } = this.canvas;\n        const [c_x, c_y] = center;\n        context.save();\n        context.translate(c_x, c_y);\n        context.rotate(angle);\n        context.beginPath();\n        context.globalAlpha = 0.5;\n        context.lineWidth = '3';\n        context.strokeStyle = '#FF9999';\n        context.rect(points[0][0] - c_x,\n            points[0][1] - c_y,\n            width,\n            height);\n        context.moveTo((points[0][0] + points[1][0]) / 2 - c_x,\n            points[0][1] - c_y);\n        context.lineTo(this.rPoint[0] - c_x, this.rPoint[1] - c_y);\n        context.stroke();\n        context.closePath();\n        context.globalAlpha = 1;\n\n        const pointList = points.concat(this.cPoints);\n        pointList.forEach((item) => {\n            const [x, y] = item;\n            context.fillStyle = '#FF4949';\n            context.fillRect(x - 7 - c_x, y - 7 - c_y, 14, 14);\n        });\n        pointList.push(this.rPoint);\n        \n        context.beginPath();\n        context.strokeStyle = '#FF4949';\n        context.fillStyle = '#FF9999';\n        context.lineWidth = '5';\n        context.arc(this.rPoint[0] - c_x, this.rPoint[1] - c_y, 8, 0, Math.PI*2, true);\n        context.stroke();\n        context.closePath();\n        context.fill();\n\n        context.restore();\n    }\n    isPointInSkeletion(point) {\n        let status = null;\n        const [x, y] = point;\n        const { angle } = this.rect;\n        const r_point = this.rect.rotatePoint(this.rPoint, angle);\n        const d_point = this.points.map(item => this.rect.rotatePoint(item, angle));\n        const c_point = this.cPoints.map(item => this.rect.rotatePoint(item, angle));\n        // 旋转点\n        (() => {\n            const [c_x, c_y] = r_point;\n            if (Math.sqrt(Math.pow(c_x - x, 2) + Math.pow(c_y - y, 2)) < 10) {\n                status = 'r_point';\n            }\n        })();\n        d_point.forEach((item, index) => {\n            const [c_x, c_y] = item;\n            if (Math.sqrt(Math.pow(c_x - x, 2) + Math.pow(c_y - y, 2)) < 10) {\n                status = `point_${index + 1}`;\n            }\n        });\n        c_point.forEach((item, index) => {\n            const [c_x, c_y] = item;\n            if (Math.sqrt(Math.pow(c_x - x, 2) + Math.pow(c_y - y, 2)) < 10) {\n                status = `c_point_${index + 1}`;\n            }\n        });\n        return status;\n    }\n}\n\n// 矩形类\nclass Rect {\n    /*\n    成员：\n    width  宽\n    height  高\n    center  中心点\n    angle  旋转角度\n    points  左上角点、右上角点、右下角点、左下角点\n    */\n    constructor(width, height, center, angle) {\n        this.height = height;\n        this.width = width;\n        this.center = center;\n        this.angle = angle;\n        this.getPoints();\n    }\n    // 通过宽高和中点获取四个点\n    getPoints() {\n        const h = this.height;\n        const w = this.width;\n        const [c_x, c_y] = this.center;\n        const points = [];\n        points[0] = [c_x - w / 2, c_y - h / 2];\n        points[1] = [c_x + w / 2, c_y - h / 2];\n        points[2] = [c_x + w / 2, c_y + h / 2];\n        points[3] = [c_x - w / 2, c_y + h / 2];\n        this.points = points;\n    }\n    // 旋转\n    rotate(angle) {\n        this.angle = angle * Math.sign(this.height);\n    }\n    // 平移\n    translate(vector) {\n        const [_x, _y] = vector;\n        const points = this.points.map(item => [item[0] + _x, item[1] + _y]);\n        this.points = points;\n        this.getCenter();\n    }\n    // 缩放\n    zoom(status, vector) {\n        const _x = parseFloat(vector[0]);\n        const _y = parseFloat(vector[1]);\n        const _angle = this.angle;\n        // 旋转后的 x 轴相对于 canvas 的位置\n        let _x_x = Math.sin((_angle + Math.PI / 2));\n        let _y_x = Math.cos((_angle + Math.PI / 2));\n        // 如果角度为 0 特殊设置，因为有些 Math.cos 不兼容\n        if (_angle === 0) {\n            _x_x = 1;\n            _y_x = 0;\n        }\n        // 移动向量 vector 在旋转后 x 轴的距离\n        const n_x = getVectorLength([_x_x, _y_x], [_x, -_y]);\n\n        // 旋转后的 y 轴相对于 canvas 的位置\n        const _x_y = Math.sin(_angle) * 5;\n        const _y_y = Math.cos(_angle) * 5;\n        // 移动向量 vector 在旋转后 y 轴的距离\n        const n_y = getVectorLength([_x_y, _y_y], [_x, -_y]);\n\n        // 通过正切计算出顶点的角度\n        const tan = Math.atan(this.height / this.width);\n        // 通过移动顶点来缩放\n        const pointZoom = (_angles) => {\n            // 获取在第一个顶点上面的移动距离\n            const n_tan = getVectorLength([-Math.cos(_angles), Math.sin(_angles)], [_x, -_y]);\n            this.width += n_tan * Math.cos(tan);\n            this.height += n_tan * Math.sin(tan);\n            this.center = [\n                this.center[0] - n_tan * Math.cos(_angles) / 2,\n                this.center[1] - n_tan * Math.sin(_angles) / 2];\n        };\n        if (status === 'point_1') { // 第1个顶点\n            const _angles = tan + _angle;\n            pointZoom(_angles);\n        } else if (status === 'point_2') { // 第2个顶点\n            const _angles = Math.PI - tan + _angle;\n            pointZoom(_angles);\n        } else if (status === 'point_3') { // 第3个点\n            const _angles = Math.PI + tan + _angle;\n            pointZoom(_angles);\n        } else if (status === 'point_4') { // 第4个点\n            const _angles = 2 * Math.PI - tan + _angle;\n            pointZoom(_angles);\n        } else if (status === 'c_point_1') {\n            this.width -= n_x;\n            this.center = [\n                this.center[0] + n_x * Math.cos(_angle) / 2,\n                this.center[1] + n_x * Math.sin(_angle) / 2];\n        } else if (status === 'c_point_2') {\n            this.height += n_y;\n            this.center = [\n                this.center[0] + n_y * Math.sin(_angle) / 2,\n                this.center[1] - n_y * Math.cos(_angle) / 2];\n        } else if (status === 'c_point_3') {\n            this.width += n_x;\n            this.center = [\n                this.center[0] + n_x * Math.cos(_angle) / 2,\n                this.center[1] + n_x * Math.sin(_angle) / 2];\n        } else if (status === 'c_point_4') {\n            this.height -= n_y;\n            this.center = [\n                this.center[0] + n_y * Math.sin(_angle) / 2,\n                this.center[1] - n_y * Math.cos(_angle) / 2];\n        }\n        this.getPoints();\n        //this.setWH();\n    }\n    // 确定点是否在矩形内部\n    isPointInRect(point) {\n        // 旋转后的位置\n        const points = this.points.map(item => this.rotatePoint(item, this.angle));\n        const p1 = points[0];\n        const p2 = points[1];\n        const p3 = points[2];\n        const p4 = points[3];\n        const x = point[0];\n        const y = -point[1];\n        // 是否在两个平行线内\n        const ratio1 = (function () {\n            const a = (p1[1] - p2[1]) / (p2[0] - p1[0]);\n            const b = -p1[1] - a * p1[0];\n            const c = -p3[1] - a * p3[0];\n            if (b > c && a * x + b > y && a * x + c < y) return true;\n            if (b < c && a * x + b < y && a * x + c > y) return true;\n            return false;\n        }());\n        // 是否在两个平行线内\n        const ratio2 = (function () {\n            const a = (p2[1] - p3[1]) / (p3[0] - p2[0]);\n            const b = -p2[1] - a * p2[0];\n            const c = -p4[1] - a * p4[0];\n            if (p3[0] - p2[0] === 0) {\n                if ((p1[0] < x && x < p2[0]) || (p1[0] > x && x > p2[0])) return true;\n            }\n            if (b > c && a * x + b > y && a * x + c < y) return true;\n            if (b < c && a * x + b < y && a * x + c > y) return true;\n            return false;\n        }());\n        if (ratio1 && ratio2) return true;\n        return false;\n    }\n    // 获取中点\n    getCenter() {\n        const p1 = this.points[0];\n        const p3 = this.points[2];\n        const x = p1[0] + p3[0];\n        const y = p1[1] + p3[1];\n        this.center = [x / 2, y / 2];\n    }\n    // 某点绕中点旋转角度\n    rotatePoint(point, angle) {\n        const [x, y] = point;\n        const [c_x, c_y] = this.center;\n        const _x = (x - c_x) * Math.cos(angle) - (y - c_y) * Math.sin(angle) + c_x;\n        const _y = (x - c_x) * Math.sin(angle) + (y - c_y) * Math.cos(angle) + c_y;\n        return [_x, _y];\n    }\n    // 设置宽高\n    setWH() {\n        this.height = Math.abs(this.points[0][1] - this.points[3][1]);\n        this.width = Math.abs(this.points[0][0] - this.points[1][0]);\n    }\n}\n\n// 图片类\nclass Photo {\n    /*\n    成员：\n    canvas  容器\n    imgInput  图片对象或资源地址\n    image  图片对象\n    isLoad  是否已载入\n    onLoad  载入完成钩子\n    id  图片id\n    options  Photo对象\n    rect  Rect对象，代表图像位置\n    orientation  图片的初始旋转角度（0，90，180，270，渲染时不会做变换，仅记录）\n    canEdit  图片是否可以编辑\n    */\n    constructor(image, canvas, onload = null, rect = null, canEdit = true, orientation = 0) {\n        this.canvas = canvas;\n        this.imgInput = image;\n        this.image = null;\n        this.onLoad = onload;\n        this.rect = rect;\n        this.canEdit = canEdit;\n        this.orientation = orientation;\n        this.id = new Date().getTime();\n        this.isLoad = false;\n        if (image instanceof Photo) {\n            this.options = image;\n            this.imgInput = this.options.imgInput;\n            this.id = this.options.id;\n        } else if (image instanceof Image) {\n            this.image = image;\n        }\n        this.prepare();\n    }\n    // 载入图片并初始化\n    prepare() {\n        if (typeof this.imgInput === 'string') {\n            this.image = new Image();\n            this.image.onload = () => {\n                if (this.isLoad) return;\n                this.isLoad = true;\n                this.init();\n            };\n            this.image.src = this.imgInput;\n            if (this.image.complete) {\n                this.isLoad = true;\n                this.init();\n            }\n        } else if (!this.image) {\n            this.image = this.imgInput;\n            this.isLoad = true;\n            this.init();\n        } else {\n            this.isLoad = true;\n            this.init();\n        }\n    }\n    // 初始化\n    init() {\n        if (this.onLoad) this.onLoad();\n        if (!this.rect) {\n            if (this.options) {\n                const {\n                    width, height, center, angle,\n                } = this.options.rect;\n                this.rect = new Rect(width,\n                    height, [center[0], center[1]], angle);\n            } else {\n                this.rect = new Rect(this.image.width,\n                    this.image.height, [this.canvas.width / 2, this.canvas.height / 2], 0);\n            }\n        }\n    }\n    // 绘制\n    draw() {\n        const { image, canvas, rect } = this;\n        const { context } = canvas;\n        const points = rect.points;\n        const [c_x, c_y] = rect.center;\n        context.save();\n        context.translate(c_x, c_y);\n        context.rotate(rect.angle);\n        context.scale(Math.sign(rect.width), Math.sign(rect.height))\n        context.drawImage(image, 0, 0, image.width, image.height,\n            points[0][0] - c_x,\n            points[0][1] - c_y,\n            rect.width,\n            rect.height);\n        context.restore();\n    }\n}\n\n// 画布类\nclass StickerCanvas {\n    /*\n    成员：\n    options  设置项\n    canvas  画布\n    width  画布的宽\n    height  画布的高\n    target  用来触发事件的元素(与canvas重合)\n    beforeLoading  数据载入之前的钩子\n    afterLoading  数据载入之后的钩子\n    data  绘制的数据\n    layers  画布的图层\n    context  canvas的上下文\n    border  活动图片的边框\n    current  当前图层\n    loadingLayerCount  正在载入的图层的个数\n    */\n    constructor(options) {\n        this.options = options;\n        const {\n            canvas,\n            height,\n            width,\n            target,\n            beforeLoading,\n            afterLoading,\n            data = []\n        } = this.options;\n        this.canvas = null;\n        this.height = height;\n        this.width = width;\n        this.target = target;\n        this.beforeLoading = beforeLoading;\n        this.afterLoading = afterLoading;\n        this.data = data;\n        this.layers = [];\n        if (typeof canvas === 'string') {\n            this.canvas = document.getElementById(canvas);\n        } else {\n            this.canvas = canvas;\n        }\n        if (typeof target === 'string') {\n            this.target = document.getElementById(target);\n        } else {\n            this.target = target;\n        }\n        this.canvas.width = width;\n        this.canvas.height = height;\n        this.context = this.canvas.getContext('2d');\n        this.loadingLayerCount = 0;\n        this.border = new Border(this);\n        this.current = null;\n        this.init();\n        this.initEvent();\n    }\n    // 初始化\n    init() {\n        this.clear();\n        if (this.beforeLoading) this.beforeLoading(this);\n\n        const add = (image) => {\n            this.loadingLayerCount += 1;\n            const lyr = new Photo(image, this, () => {\n                setTimeout(() => {\n                    this.loadingLayerCount -= 1;\n                    if (this.loadingLayerCount < 1) {\n                        this.draw();\n                    }\n                }, 100);\n            }, image.rect, image.canEdit, image.orientation);\n            this.layers.push(lyr);\n        };\n\n        // 恢复数据\n        this.data.forEach((item) => {\n            if (typeof item !== 'function') {\n                add(item);\n            }\n        });\n        if (this.afterLoading) this.afterLoading(this);\n    }\n    // 初始化事件响应\n    initEvent() {\n        this.target.addEventListener('mousedown', e => {\n            let p_x = e.pageX;\n            let p_y = e.pageY;\n            const position = getDocPosition(this.target);\n            const scale = this.width / this.target.offsetWidth;\n            const point = [\n                (p_x - position.x) * scale,\n                (p_y - position.y) * scale,\n            ];\n            const status = this.selectPhoto(point);\n            if (status) {\n                const move = (event) => {\n                    const m_x = event.pageX;\n                    const m_y = event.pageY;\n                    const vector = [(m_x - p_x) * scale, (m_y - p_y) * scale];\n                    if (status === 1) {\n                        this.current.rect.translate(vector);\n                    } else if (status === 'r_point') {\n                        const e_point = [(m_x - position.x) * scale, (m_y - position.y) * scale];\n                        const angle = StickerCanvas.getAngle(\n                            this.current.rect.center,\n                            this.border.rPoint,\n                            e_point,\n                        );\n                        if (!isNaN(angle)) {\n                            this.current.rect.rotate(angle);\n                        } else {\n                            return;\n                        }\n                    } else {\n                        this.current.rect.zoom(status, vector);\n                    }\n                    this.draw();\n                    p_x = m_x;\n                    p_y = m_y;\n                };\n                this.target.addEventListener('mousemove', move);\n                this.target.addEventListener('mouseup', () => {\n                    this.target.removeEventListener('mousemove', move);\n                });\n            }\n        });\n        this.target.addEventListener('touchstart', e => {\n            e.preventDefault();\n            let p_x = e.touches[0].pageX;\n            let p_y = e.touches[0].pageY;\n            const position = getDocPosition(this.target);\n            const scale = this.width / this.target.offsetWidth;\n            const point = [\n                (p_x - position.x) * scale,\n                (p_y - position.y) * scale,\n            ];\n            const status = this.selectPhoto(point);\n            if (status) {\n                const move = (event) => {\n                    const m_x = event.touches[0].pageX;\n                    const m_y = event.touches[0].pageY;\n                    const vector = [(m_x - p_x) * scale, (m_y - p_y) * scale];\n                    if (status === 1) {\n                        this.current.rect.translate(vector);\n                    } else if (status === 'r_point') {\n                        const e_point = [(m_x - position.x) * scale, (m_y - position.y) * scale];\n                        const angle = StickerCanvas.getAngle(\n                            this.current.rect.center,\n                            this.border.rPoint,\n                            e_point,\n                        );\n                        if (!isNaN(angle)) {\n                            this.current.rect.rotate(angle);\n                        } else {\n                            return;\n                        }\n                    } else {\n                        this.current.rect.zoom(status, vector);\n                    }\n                    this.draw();\n                    p_x = m_x;\n                    p_y = m_y;\n                };\n                this.target.addEventListener('touchmove', move);\n                this.target.addEventListener('touchend', () => {\n                    this.target.removeEventListener('touchmove', move);\n                });\n            }\n        });\n    }\n    // 旋转角度\n    static getAngle(cen, first, second) {\n        const f_c_x = first[0] - cen[0];\n        const f_c_y = cen[1] - first[1];\n        const s_c_x = second[0] - cen[0];\n        const s_c_y = cen[1] - second[1];\n        const c = Math.sqrt(f_c_x * f_c_x + f_c_y * f_c_y)\n            * Math.sqrt(s_c_x * s_c_x + s_c_y * s_c_y);\n        if (c === 0) return -1;\n        const angle = Math.acos((f_c_x * s_c_x + f_c_y * s_c_y) / c);\n        // 第一象限\n        if (cen[0] - second[0] < 0 && cen[1] - second[1] < 0) {\n            return angle;\n        }\n        // 第二象限\n        if (cen[0] - second[0] < 0 && cen[1] - second[1] > 0) {\n            return angle;\n        }\n        // 第三象限\n        if (cen[0] - second[0] > 0 && cen[1] - second[1] < 0) {\n            return 2 * Math.PI - angle;\n        }\n        // 第四象限\n        if (cen[0] - second[0] > 0 && cen[1] - second[1] > 0) {\n            return 2 * Math.PI - angle;\n        }\n        return null;\n    }\n    addCommand(command) {\n        this.layers.push(command);\n        if (this.loadingLayerCount > 0) {\n            setTimeout(() => {\n                this.draw();\n            }, 100);\n            return;\n        }\n        this.draw();\n    }\n    // 添加图片\n    addPhoto(image, rectOptions = null, canEdit = true, orientation = 0) {\n        let rect = null;\n        if (rectOptions) {\n            rect = new Rect(rectOptions.width,\n                rectOptions.height,\n                [rectOptions.centerX, rectOptions.centerY],\n                rectOptions.angle);\n        }\n        if (typeof image === 'string') {\n            this.loadingLayerCount += 1;\n            const lyr = new Photo(image, this, () => {\n                setTimeout(() => {\n                    this.loadingLayerCount -= 1;\n                    if (this.loadingLayerCount < 1) {\n                        this.draw();\n                    }\n                }, 100);\n            }, rect, canEdit, orientation);\n            this.layers.push(lyr);\n        } else {\n            const lyr = new Photo(image, this, null, rect, canEdit, orientation);\n            this.layers.push(lyr);\n            this.draw();\n        }\n    }\n\n    selectPhoto(point) {\n        if (this.current) {\n            const status = this.border.isPointInSkeletion(point);\n            if (status) {\n                return status;\n            }\n        }\n        const layers = [].concat(this.layers)\n            .reverse();\n        this.current = null;\n        let c_index = 0;\n        layers.forEach((item, index) => {\n            if (typeof item !== 'function' && !this.current && item.rect.isPointInRect(point) && item.canEdit) {\n                this.current = item;\n                c_index = index + 1;\n            }\n        });\n        if (this.current) {\n            this.chooseItem(this.layers.length - c_index);\n            return 1;\n        } else {\n            this.draw();\n        }\n        return 0;\n    }\n\n    chooseItem(index) {\n        if (this.layers[index].canEdit) {\n            this.current = this.layers[index];\n            this.layers.splice(index, 1);\n            this.layers.push(this.current);\n            this.draw();\n        }\n    }\n\n    removeItem(index) {\n        this.layers.splice(index, 1);\n        this.draw();\n    }\n    // 将当前画布的图像导出为png\n    export() {\n        const canvas = document.createElement('canvas');\n\n        const bg = this.layers[0];\n        if (bg.orientation == 90 || bg.orientation == 270) {\n            canvas.width = bg.image.height;\n            canvas.height = bg.image.width;\n        } else {    \n            canvas.width = bg.image.width;\n            canvas.height = bg.image.height;\n        }\n        const context = canvas.getContext('2d');\n        context.save();\n        context.translate(canvas.width / 2, canvas.height / 2);\n        context.rotate(bg.rect.angle);\n        context.drawImage(bg.image, 0, 0, bg.image.width, bg.image.height,\n            -bg.image.width / 2, -bg.image.height / 2, bg.image.width, bg.image.height);\n        context.restore();\n        \n        let xRate = bg.image.width / bg.rect.width;\n        let yRate = bg.image.height / bg.rect.height;\n        let xOffset = bg.rect.center[0] - bg.rect.width / 2;\n        let yOffset = bg.rect.center[1] - bg.rect.height / 2;\n        if (bg.orientation == 90 || bg.orientation == 270) {\n            xRate = bg.image.height / bg.rect.height;\n            yRate = bg.image.width / bg.rect.width;\n            xOffset = bg.rect.center[0] - bg.rect.height / 2;\n            yOffset = bg.rect.center[1] - bg.rect.width / 2;\n        }\n        \n        if (this.layers[1]) {\n            const fg = this.layers[1];\n            const points = fg.rect.points;\n            let [c_x, c_y] = fg.rect.center;\n            c_x = (c_x - xOffset) * xRate;\n            c_y = (c_y - yOffset) * yRate;\n            context.save();\n            context.translate(c_x, c_y);\n            context.rotate(fg.rect.angle);\n            context.scale(Math.sign(fg.rect.width), Math.sign(fg.rect.height))\n            context.drawImage(fg.image, 0, 0, fg.image.width, fg.image.height,\n                (points[0][0] - xOffset) * xRate - c_x,\n                (points[0][1] - yOffset) * yRate - c_y,\n                fg.rect.width * xRate,\n                fg.rect.height * yRate);\n            context.restore();\n        }\n        \n        return canvas.toDataURL(\"image/png\");\n    }\n    // 清理画布\n    clear() {\n        // Store the current transformation matrix\n        this.context.save();\n        // Use the identity matrix while clearing the canvas\n        this.context.setTransform(1, 0, 0, 1, 0, 0);\n        this.context.clearRect(0, 0, this.width, this.height);\n        // Restore the transform\n        this.context.restore();\n    }\n\n    save() {\n        const data = this.layers.map((item) => {\n            const { rect, id, img } = item;\n            return { rect, id, img };\n        });\n       return data;\n    }\n\n    draw() {\n        this.clear();\n        this.layers.forEach(item => {\n            if (typeof item === 'function') {\n                item.apply(null, this.context, this.canvas);\n            } else {\n                item.draw();\n            }\n        });\n        if (this.current) {\n            this.border.refresh(this.current.rect);\n        }\n    }\n}\nexport default StickerCanvas;\n","import urls from '../utils/urls';\r\n\r\nexport default {\r\n    // 分享图像缓存\r\n    shareImageSrc: null,\r\n    // ajax获取分享图片（防止canvas导出时报跨域的错）\r\n    getShareImageSrc(filename, callback) {\r\n        if (this.shareImageSrc) {\r\n            callback(this.shareImageSrc);\r\n        } else {\r\n            const self = this;\r\n            const xhr = new XMLHttpRequest();\r\n            xhr.onload = function () {\r\n                const url = URL.createObjectURL(this.response);\r\n                self.shareImageSrc = url;\r\n                callback(url);\r\n            };\r\n            xhr.open('GET', urls.assetsBaseUrl + filename, true);\r\n            xhr.responseType = 'blob';\r\n            xhr.send();\r\n        }\r\n    },\r\n    // 排版图片，填充容器并居中（图片完整显示，留空白）\r\n    imgContain(cw, ch, iw, ih) {\r\n        const xRate = cw / iw;\r\n        const yRate = ch / ih;\r\n        const setRate = xRate < yRate ? xRate : yRate;\r\n        const imgWidth = iw * setRate;\r\n        const imgHeight = ih * setRate;\r\n        const imgX = (cw - imgWidth) / 2;\r\n        const imgY = (ch - imgHeight) / 2;\r\n        return {imgWidth, imgHeight, imgX, imgY, rate: setRate};\r\n    },\r\n    // 排版图片，填充容器并居中（图片不留空白）\r\n    imgCover(cw, ch, iw, ih) {\r\n        const xRate = cw / iw;\r\n        const yRate = ch / ih;\r\n        const setRate = xRate > yRate ? xRate : yRate;\r\n        const imgWidth = iw * setRate;\r\n        const imgHeight = ih * setRate;\r\n        const imgX = (cw - imgWidth) / 2;\r\n        const imgY = (ch - imgHeight) / 2;\r\n        return {imgWidth, imgHeight, imgX, imgY, rate: setRate};\r\n    }\r\n}","<template>\n  <div id=\"editor\" ref=\"editor\">\n    <div id=\"editorUI\" :class=\"{'loading': loading}\">\n      <div ref=\"canvasContainer\">\n      </div>\n      <button id=\"resetBtn\" @click=\"resetMask\" :style=\"{width: $t('editor.reset.width')}\">{{ $t('editor.reset.text') }}</button>\n      <div id=\"maskStore\" ref=\"maskStore\">\n        <p class=\"title\">{{ $t('editor.changeMask') }}</p>\n        <div class=\"list\">\n          <ul>\n            <li v-for=\"m in maskData.masks\" :key=\"m.name\" @click=\"changeMask(m)\">\n              <img :src=\"maskData.baseUrl + m.name\">\n            </li>\n          </ul>\n        </div>\n      </div>\n      <div class=\"control\" ref=\"control\">\n        <button id=\"reuploadBtn\" @click=\"reupload\" :style=\"{width: $t('editor.reselectImg.width')}\">{{ $t('editor.reselectImg.text') }}</button>\n        <button id=\"saveBtn\" @click=\"save\" :style=\"{width: $t('editor.saveImg.width')}\">{{ $t('editor.saveImg.text') }}</button>\n      </div>\n    </div>\n    <div v-if=\"loading\" id=\"loading\">\n      <div :style=\"{width: $t('editor.loading.width'), height: $t('editor.loading.height')}\">\n        <p>\n          <b>{{ $t('editor.loading.title') }}</b>\n          <br>\n          {{ $t('editor.loading.text1') }}\n          <br>\n          {{ $t('editor.loading.text2') }}\n        </p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n/* eslint-disable no-console */\nimport faceApiUtil from '../utils/faceApiUtil';\nimport StickerCanvas from '../utils/stickerCanvas';\nimport maskData from '../utils/maskData';\nimport maskHelper from '../utils/maskHelper';\nimport util from '../utils/util';\nimport EXIF from 'exif-js';\n\nexport default {\n  props: {\n    fileId: Number\n  },\n  data() {\n    return {\n      currentFileId: 0,\n      editor: null,\n      canvas: null,\n      maskData: maskData,\n      maskInfo: null,\n      realImgInfo: null,\n      loading: false\n    }\n  },\n  methods: {\n    loadImg(file) {\n      if (this.canvas) {\n        this.canvas.remove();\n      }\n      this.canvas = document.createElement('canvas');\n      this.canvas.width = this.$refs.editor.clientWidth;\n      this.canvas.height = this.$refs.editor.clientHeight - this.$refs.maskStore.clientHeight - this.$refs.control.clientHeight;\n      this.$refs.canvasContainer.appendChild(this.canvas);\n      this.editor = new StickerCanvas({\n        canvas: this.canvas,\n        target: this.canvas,\n        width: this.canvas.width,\n        height: this.canvas.height\n      });\n      const editor = this.editor;\n      const self = this;\n      //获取图片Orientation参数\n      EXIF.getData(file, function () {\n        console.log(EXIF.getAllTags(this));\n        const EXIF_orientation = EXIF.getTag(this, 'Orientation');  // 解决移动设备照片方向问题\n        const reader = new FileReader();\n        reader.readAsDataURL(file);  // 发起异步请求\n        reader.onload = function () {\n          const img = new Image();\n          img.src = this.result;\n          img.onload = function () {\n            let width = img.width;\n            let height = img.height;\n            let angle = 0;\n            let orientation = 0;\n            if(EXIF_orientation && EXIF_orientation != 1){\n              switch(EXIF_orientation){\n                // 旋转90度\n                case 6:\n                  angle = Math.PI / 2;\n                  width = img.height;\n                  height = img.width;\n                  orientation = 90;\n                  break;\n                // 旋转180度\n                case 3:\n                  angle = Math.PI;\n                  orientation = 180;\n                  break;\n                // 旋转270度\n                case 8:\n                  angle = 3 * Math.PI / 2;\n                  width = img.height;\n                  height = img.width;\n                  orientation = 270;\n                  break;\n              }\n            }\n            // 等比例缩放图片\n            const {imgWidth, imgHeight, imgX, imgY, rate} = util.imgContain(editor.width, editor.height, width, height);\n            editor.addPhoto(img, {\n              width: img.width * rate,\n              height: img.height * rate,\n              centerX: editor.width / 2,\n              centerY: editor.height / 2,\n              angle: angle\n            }, false, orientation);\n            self.realImgInfo = {\n              width: imgWidth,\n              height: imgHeight,\n              position: [imgX, imgY]\n            };\n            self.loading = true;\n\n            setTimeout(() => {    \n              const rimg = new Image();\n              rimg.src = editor.export();  // 放进算法前导出一次确保图片方向正确\n              rimg.onload = function () {\n                faceApiUtil.detectPic(rimg, editor, self.realImgInfo, maskInfo => {\n                  self.maskInfo = maskInfo;\n                  self.loading = false;\n                }, e => {\n                  console.log(e);\n                  self.maskInfo = maskHelper.wearAMaskAsAFool(self.editor, self.realImgInfo);\n                  self.loading = false;\n                });\n              }\n            }, 300);  // 留时间刷新界面\n          }\n        }\n      });\n    },\n    resetMask () {\n      if (this.maskInfo && this.editor) {\n        maskHelper.resetMask(this.maskInfo, this.editor, this.realImgInfo);\n      }\n    },\n    changeMask (m) {\n      if (this.maskInfo && this.editor) {\n        maskHelper.changeMask(m, this.editor);\n      }\n    },\n    reupload () {\n      this.$emit('navTo', 'index');\n    },\n    save () {\n      this.$store.commit('setEditor', this.editor);\n      this.$emit('navTo', 'export');\n    }\n  },\n  watch: {\n    fileId (v) {\n      if (v != this.currentFileId && this.$store.state.userImgInfo && v == this.$store.state.userImgInfo.id) {\n        this.loadImg(this.$store.state.userImgInfo.file);\n        this.currentFileId = v;\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n#editor, #editorUI {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n#maskStore {\n  position: absolute;\n  width: 100%;\n  bottom: 60px;\n  background: #f3b8b1;\n}\n#maskStore .title {\n  background: #ff664d;\n  color: white;\n  height: 30px;\n  line-height: 30px;\n}\n#maskStore .list {\n  overflow-x: auto;\n  overflow-y: hidden;\n  height: 90px;\n}\n#maskStore ul {\n  width: auto;\n  white-space: nowrap;\n}\n#maskStore li {\n  position: relative;\n  width: 80px;\n  height: 80px;\n  font-size: 14px;\n  display: inline-block;\n  margin: 5px;\n  padding: 5px;\n  text-align: center;\n  vertical-align: middle;\n}\n#maskStore li:hover {\n  border: 1px dashed #666;\n  border-radius: 5px;\n}\n#maskStore img {\n  position: relative;\n  width: 100%;\n  vertical-align: middle;\n}\n.control {\n  position: absolute;\n  width: 100%;\n  bottom: 0px;\n  height: 60px;\n  background: #ff664d;\n}\n.control button {\n  height: 40px;\n  margin: 10px;\n  background: white;\n  border-radius: 20px;\n  appearance: none;\n  border: none;\n  font-size: 16px;\n  box-shadow: 0px 0px 5px #888;\n}\nbutton:hover {\n  background: #f5dcd9;\n}\n#resetBtn {\n  position: absolute;\n  top: 0px;\n  right: 0px;\n  width: 60px;\n  height: 25px;\n  margin: 10px;\n  background: white;\n  border-radius: 13px;\n  appearance: none;\n  border: none;\n  font-size: 14px;\n  box-shadow: 0px 0px 5px #ccc;\n  opacity: 0.6;\n}\n#editorUI.loading {\n  filter: blur(20px);\n}\n#loading {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0px;\n}\n#loading > div {\n  position: relative;\n  padding: 10px;\n  top: 50%;\n  transform: translateY(-50%);\n  margin: 0 auto;\n  background: white;\n  border-radius: 5px;\n  font-size: 16px;\n  line-height: 25px;\n  box-shadow: 0px 0px 10px #ccc;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Editor.vue?vue&type=template&id=1b4fae52&scoped=true&\"\nimport script from \"./Editor.vue?vue&type=script&lang=js&\"\nexport * from \"./Editor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Editor.vue?vue&type=style&index=0&id=1b4fae52&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1b4fae52\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"export\"}},[_c('div',{class:{'loading': _vm.loading},attrs:{\"id\":\"exportUI\"}},[_c('p',{ref:\"ic\",staticClass:\"img-container\"},[_c('img',{style:(_vm.imgStyle),attrs:{\"src\":_vm.imgUrl},on:{\"load\":_vm.onImgLoaded}})]),_c('button',{style:({width: _vm.$t('export.share.width')}),attrs:{\"id\":\"shareBtn\"},on:{\"click\":_vm.share}},[_vm._v(_vm._s(_vm.$t('export.share.text')))]),_c('div',{ref:\"title\",staticClass:\"title\"},[_c('p',[_vm._v(_vm._s(_vm.$t('export.title')))]),_c('div',{staticClass:\"control\"},[_c('button',{style:({width: _vm.$t('export.backToEditor.width')}),on:{\"click\":_vm.backToEditor}},[_vm._v(_vm._s(_vm.$t('export.backToEditor.text')))]),_c('button',{style:({width: _vm.$t('export.backToIndex.width')}),on:{\"click\":_vm.backToIndex}},[_vm._v(_vm._s(_vm.$t('export.backToIndex.text')))])])])]),(_vm.loading)?_c('div',{attrs:{\"id\":\"loading\"}},[_c('div',{style:({width: _vm.$t('export.loading.width'), height: _vm.$t('export.loading.height')})},[_c('p',[_c('b',[_vm._v(_vm._s(_vm.$t('export.loading.title')))])])])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"export\">\n    <div id=\"exportUI\" :class=\"{'loading': loading}\">\n      <p class=\"img-container\" ref=\"ic\"><img :src=\"imgUrl\" :style=\"imgStyle\" @load=\"onImgLoaded\"></p>\n      <button id=\"shareBtn\" @click=\"share\" :style=\"{width: $t('export.share.width')}\">{{ $t('export.share.text') }}</button>\n      <div class=\"title\" ref=\"title\">\n        <p>{{ $t('export.title') }}</p>\n        <div class=\"control\">\n          <button @click=\"backToEditor\" :style=\"{width: $t('export.backToEditor.width')}\">{{ $t('export.backToEditor.text') }}</button>\n          <button @click=\"backToIndex\" :style=\"{width: $t('export.backToIndex.width')}\">{{ $t('export.backToIndex.text') }}</button>\n        </div>\n      </div>\n    </div>\n    <div v-if=\"loading\" id=\"loading\">\n      <div :style=\"{width: $t('export.loading.width'), height: $t('export.loading.height')}\">\n        <p>\n          <b>{{ $t('export.loading.title') }}</b>\n        </p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n/* eslint-disable no-console */\nimport { mapState } from 'vuex';\nimport util from '../utils/util';\n\nexport default {\n  data() {\n    return {\n      imgStyle: {},\n      loading: true\n    }\n  },\n  computed: mapState({\n    imgUrl: 'finishImg'\n  }),\n  methods: {\n    onImgLoaded () {\n      if (this.imgUrl) {\n        this.loading = false;\n      }\n    },\n    backToIndex () {\n      this.$emit('navTo', 'index');\n    },\n    backToEditor () {\n      this.$emit('navTo', 'editor');\n    },\n    share () {\n      this.$emit('navTo', 'share');\n    }\n  },\n  created () {\n    if (!this.$store.state.editor) {\n      this.$emit('navTo', 'index');\n    } else {\n      this.$store.commit('setFinishImg', null);\n    }\n  },\n  mounted () {\n    const cw = this.$refs.ic.clientWidth;\n    const ch = this.$refs.ic.clientHeight - this.$refs.title.clientHeight;\n    const bg = this.$store.state.editor.layers[0];\n    let iw = bg.image.width;\n    let ih = bg.image.height;\n    if (bg.orientation == 90 || bg.orientation == 270) {\n      iw = bg.image.height;\n      ih = bg.image.width;\n    }\n    const {imgWidth, imgHeight, imgX, imgY} = util.imgContain(cw, ch, iw, ih);\n    this.imgStyle = {\n      width: imgWidth + 'px',\n      height: imgHeight + 'px',\n      left: imgX + 'px',\n      top: (imgY + this.$refs.title.clientHeight) + 'px'\n    }\n    setTimeout(() => {\n      this.$store.commit('setFinishImg', this.$store.state.editor.export());\n    }, 300);  // 留时间刷新界面\n  }\n}\n</script>\n\n<style scoped>\n#export, #exportUI {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n.title {\n  position: absolute;\n  width: 100%;\n  height: 90px;\n  top: 0px;\n  background: #ff664d;\n}\n.title p {\n  color: white;\n  line-height: 30px;\n}\n.img-container {\n  height: 100%;\n  position: relative;\n}\nimg {\n  display: block;\n  position: absolute;\n}\n.control {\n  width: 100%;\n  height: 60px;\n  background: #ff9c92;\n}\nbutton {\n  height: 40px;\n  margin: 10px;\n  background: white;\n  border-radius: 20px;\n  appearance: none;\n  border: none;\n  font-size: 16px;\n  box-shadow: 0px 0px 5px #888;\n}\nbutton:hover {\n  background: #f5dcd9;\n}\n#shareBtn {\n  position: absolute;\n  bottom: 0px;\n  right: 0px;\n  height: 25px;\n  margin: 10px;\n  background: white;\n  border-radius: 13px;\n  appearance: none;\n  border: none;\n  font-size: 14px;\n  box-shadow: 0px 0px 5px #ccc;\n  opacity: 0.6;\n}\n#exportUI.loading {\n  filter: blur(20px);\n}\n#loading {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0px;\n}\n#loading > div {\n  position: relative;\n  padding: 10px;\n  top: 50%;\n  transform: translateY(-50%);\n  margin: 0 auto;\n  background: white;\n  border-radius: 5px;\n  font-size: 16px;\n  line-height: 30px;\n  box-shadow: 0px 0px 10px #ccc;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Export.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Export.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Export.vue?vue&type=template&id=20cc60b4&scoped=true&\"\nimport script from \"./Export.vue?vue&type=script&lang=js&\"\nexport * from \"./Export.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Export.vue?vue&type=style&index=0&id=20cc60b4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"20cc60b4\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"share\"}},[_c('div',{class:{'loading': _vm.loading},attrs:{\"id\":\"shareUI\"}},[_c('p',{ref:\"ic\",staticClass:\"img-container\"},[_c('img',{style:(_vm.imgStyle),attrs:{\"src\":_vm.imgUrl},on:{\"load\":_vm.onImgLoaded}})]),_c('div',{ref:\"title\",staticClass:\"title\"},[_c('p',[_vm._v(_vm._s(_vm.$t('share.title')))])]),_c('div',{ref:\"control\",staticClass:\"control\"},[_c('button',{style:({width: _vm.$t('share.back.width')}),on:{\"click\":_vm.back}},[_vm._v(_vm._s(_vm.$t('share.back.text')))])])]),(_vm.loading)?_c('div',{attrs:{\"id\":\"loading\"}},[_c('div',{style:({width: _vm.$t('share.loading.width'), height: _vm.$t('share.loading.height')})},[_c('p',[_c('b',[_vm._v(_vm._s(_vm.$t('share.loading.title')))])])])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"share\">\n    <div id=\"shareUI\" :class=\"{'loading': loading}\">\n      <p class=\"img-container\" ref=\"ic\"><img :src=\"imgUrl\" :style=\"imgStyle\" @load=\"onImgLoaded\"></p>\n      <div class=\"title\" ref=\"title\">\n        <p>{{ $t('share.title') }}</p>\n      </div>\n      <div class=\"control\" ref=\"control\">\n        <button @click=\"back\" :style=\"{width: $t('share.back.width')}\">{{ $t('share.back.text') }}</button>\n      </div>\n    </div>\n    <div v-if=\"loading\" id=\"loading\">\n      <div :style=\"{width: $t('share.loading.width'), height: $t('share.loading.height')}\">\n        <p>\n          <b>{{ $t('share.loading.title') }}</b>\n        </p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n/* eslint-disable no-console */\nimport util from '../utils/util';\n\nexport default {\n  data() {\n    return {\n      imgUrl: '',\n      imgStyle: {},\n      loading: true\n    }\n  },\n  methods: {\n    onImgLoaded () {\n      if (this.imgUrl) {\n        this.loading = false;\n      }\n    },\n    back () {\n      this.$emit('navTo', 'export');\n    }\n  },\n  created () {\n    if (!this.$store.state.finishImg) {\n      this.$emit('navTo', 'index');\n    }\n  },\n  mounted () {\n    setTimeout(() => {\n      const self = this;\n      const img = new Image();\n      img.src = this.$store.state.finishImg;\n      img.onload = function () {\n        util.getShareImageSrc(self.$t('share.shareImg.filename'), sUrl => {\n          const simg = new Image();\n          simg.src = sUrl;\n          simg.onload = function () {\n            const {imgWidth, imgHeight, imgX, imgY} =\n              util.imgContain(self.$refs.ic.clientWidth,\n              self.$refs.ic.clientHeight - self.$refs.title.clientHeight - self.$refs.control.clientHeight,\n              simg.width, simg.height);\n            self.imgStyle = {\n              width: imgWidth + 'px',\n              height: imgHeight + 'px',\n              left: imgX + 'px',\n              top: (imgY + self.$refs.title.clientHeight) + 'px'\n            }\n\n            const canvas = document.createElement('canvas');\n            canvas.width = simg.width;\n            canvas.height = simg.height;\n            const context = canvas.getContext('2d');\n            context.drawImage(simg, 0, 0, simg.width, simg.height,\n              0, 0, canvas.width, canvas.height);\n            const [x0, y0] = JSON.parse(self.$t('share.shareImg.p0'));  // 插图区域左上角点\n            const [x1, y1] = JSON.parse(self.$t('share.shareImg.p1'));  // 插图区域右下角点\n            const rect = util.imgCover(x1 - x0, y1 - y0, img.width, img.height);\n            const [xBlank, yBlank] = [-rect.imgX / rect.rate, -rect.imgY / rect.rate];\n            context.drawImage(img, xBlank, yBlank,\n              img.width - xBlank * 2, img.height - yBlank * 2,\n              x0, y0, rect.imgWidth + rect.imgX * 2, rect.imgHeight + rect.imgY * 2);\n            self.imgUrl = canvas.toDataURL(\"image/png\");\n          }\n        });\n      }\n    }, 300);  // 留时间刷新界面\n  }\n}\n</script>\n\n<style scoped>\n#share, #shareUI {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n.title {\n  position: absolute;\n  width: 100%;\n  height: 30px;\n  top: 0px;\n  background: #ff664d;\n}\n.title p {\n  color: white;\n  line-height: 30px;\n}\n.img-container {\n  height: 100%;\n  position: relative;\n}\nimg {\n  display: block;\n  position: absolute;\n  box-shadow: 0px 0px 7px #ccc;\n}\n.control {\n  width: 100%;\n  height: 60px;\n  position: absolute;\n  bottom: 0;\n}\nbutton {\n  height: 40px;\n  margin: 10px;\n  background: #ff8571;\n  color: white;\n  border-radius: 20px;\n  appearance: none;\n  border: none;\n  font-size: 16px;\n  box-shadow: 0px 0px 5px #888;\n}\nbutton:hover {\n  background: #ff664d;\n}\n#shareBtn {\n  position: absolute;\n  bottom: 0px;\n  right: 0px;\n  width: 95px;\n  height: 25px;\n  margin: 10px;\n  background: white;\n  border-radius: 13px;\n  appearance: none;\n  border: none;\n  font-size: 14px;\n  box-shadow: 0px 0px 5px #ccc;\n  opacity: 0.6;\n}\n#shareUI.loading {\n  filter: blur(20px);\n}\n#loading {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0px;\n}\n#loading > div {\n  position: relative;\n  padding: 10px;\n  top: 50%;\n  transform: translateY(-50%);\n  margin: 0 auto;\n  background: white;\n  border-radius: 5px;\n  font-size: 16px;\n  line-height: 30px;\n  box-shadow: 0px 0px 10px #ccc;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Share.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Share.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Share.vue?vue&type=template&id=180f5125&scoped=true&\"\nimport script from \"./Share.vue?vue&type=script&lang=js&\"\nexport * from \"./Share.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Share.vue?vue&type=style&index=0&id=180f5125&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"180f5125\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n    <div id=\"header\" :style=\"{height: $t('logo.height') + 'vh'}\">\n      <img id=\"logo\" :src=\"logoPath\">\n      <a id=\"forkMe\" href=\"https://github.com/zamhown/wear-a-mask\">Fork me on GitHub!</a>\n    </div>\n    <div id=\"contentContainer\" :style=\"{height: 100 - $t('logo.height') + 'vh'}\">\n      <div id=\"content\">\n        <Index v-show=\"nav=='index'\" @navTo=\"navTo\" />\n        <Editor v-show=\"nav=='editor'\" :fileId=\"currentFileId\" @navTo=\"navTo\" />\n        <Export v-if=\"nav=='export'\" @navTo=\"navTo\" />\n        <Share v-if=\"nav=='share'\" @navTo=\"navTo\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Index from './components/Index.vue'\nimport Editor from './components/Editor.vue'\nimport Export from './components/Export.vue'\nimport Share from './components/Share.vue'\n\nimport urls from './utils/urls'\n\nexport default {\n  name: 'app',\n  components: {\n    Index,\n    Editor,\n    Export,\n    Share\n  },\n  data() {\n    return {\n      logoPath: urls.assetsBaseUrl + this.$t('logo.filename'),\n      nav: 'index',\n      currentFileId: 0\n    }\n  },\n  methods: {\n    navTo(where, data) {\n      this.nav = where;\n      if (data) {\n        this.currentFileId = data;\n      }\n    }\n  },\n  created () {\n    document.title = this.$t('title');\n  }\n}\n</script>\n\n<style>\n* {\n  box-sizing: border-box;\n  user-select: none;\n}\nhtml, body, p, ul, li {\n  margin: 0;\n  padding: 0;\n}\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  background: white;\n  color: #2c3e50;\n}\n#header, #contentContainer {\n  max-width: 600px;\n}\n#header {\n  position: relative;\n  margin: 0px auto;\n}\n#logo {\n  height: 100%;\n}\n#forkMe {\n  display: block;\n  position: absolute;\n  top: 0px;\n  right: 20px;\n  background: #f2bb43;\n  color: white;\n  text-decoration: none;\n  font-size: 14px;\n  line-height: 14px;\n  font-family: 'Times New Roman', Times, serif;\n  padding: 8px 15px;\n  border-radius: 0px 0px 20px 20px;\n  box-shadow: 0px 0px 10px #ccc;\n}\n#contentContainer {\n  position: relative;\n  margin: 0px auto;\n  padding: 0px 15px 15px 15px;\n}\n#content {\n  height: 100%;\n  border: 2px solid #ff9c92;\n  border-radius: 5px;\n  box-shadow: 0px 0px 5px #ccc;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=7d515c9c&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\r\nimport Vuex from 'vuex'\r\n\r\nVue.use(Vuex)\r\n\r\n// initial state\r\nconst state = {\r\n  userImgInfo: null,\r\n  editor: null,\r\n  finishImg: null\r\n}\r\n\r\n// getters\r\nconst getters = {}\r\n\r\n// actions\r\nconst actions = {}\r\n\r\n// mutations\r\nconst mutations = {\r\n  setUserImgInfo (state, data) {\r\n    state.userImgInfo = data\r\n  },\r\n  setEditor (state, data) {\r\n    state.editor = data\r\n  },\r\n  setFinishImg (state, data) {\r\n    state.finishImg = data\r\n  }\r\n}\r\n\r\nexport default new Vuex.Store({\r\n  state,\r\n  getters,\r\n  actions,\r\n  mutations\r\n})\r\n","export default {\r\n    language: 'English',\r\n    title: 'Wear a Mask on Your Avatar!',\r\n    logo: {\r\n        filename: 'logo-title-en.svg',\r\n        height: '20'  // vh\r\n    },\r\n    index: {\r\n        title: {\r\n            text: 'Mask at critical moments!',\r\n            letterSpacing: '1px'\r\n        },\r\n        slogan: {\r\n            text1: 'Wear a mask on your SNS avatars, ',\r\n            text2: \"let's pay more attention to public health. \",\r\n            space: ' ',\r\n            letterSpacing: '0px'\r\n        },\r\n        selectImg: {\r\n            text: 'Select an Image',\r\n            width: '190px'\r\n        },\r\n        description: {\r\n            text1: 'This page can automatically put a mask on your avatar, and you can also edit the position and size of the mask.',\r\n            text2: \"The face detection algorithm is based on the SSD MobileNet V1 neural network model. You don't need to upload pictures and the site don't retain any data.\",\r\n            letterSpacing: '0px'\r\n        }\r\n    },\r\n    editor: {\r\n        loading: {\r\n            title: 'Face detection is in progress...',\r\n            text1: 'Because the algorithm runs in the browser all the time,',\r\n            text2: 'the calculation speed may depend on the performance of the device.',\r\n            width: '280px',\r\n            height: '144px'\r\n        },\r\n        reset: {\r\n            text: 'Reset',\r\n            width: '70px'\r\n        },\r\n        changeMask: 'Change the Mask',\r\n        reselectImg: {\r\n            text: 'Reselect',\r\n            width: '120px'\r\n        },\r\n        saveImg: {\r\n            text: 'Save Image',\r\n            width: '120px'\r\n        },\r\n    },\r\n    export: {\r\n        loading: {\r\n            title: 'Exporting...',\r\n            width: '200px',\r\n            height: '50px'\r\n        },\r\n        title: 'Long Press or Right Click to Save the Image',\r\n        backToEditor: {\r\n            text: 'Continue Editing',\r\n            width: '140px'\r\n        },\r\n        backToIndex: {\r\n            text: 'Reselect',\r\n            width: '100px'\r\n        },\r\n        share: {\r\n            text: 'Share',\r\n            width: '70px'\r\n        }\r\n    },\r\n    share: {\r\n        loading: {\r\n            title: 'Generating...',\r\n            width: '200px',\r\n            height: '50px'\r\n        },\r\n        title: 'Save the Image and Share It With Friends!',\r\n        back: {\r\n            text: 'Back',\r\n            width: '120px'\r\n        },\r\n        shareImg: {\r\n            filename: 'share-github-chs.png',\r\n            p0: '[157, 272]',  // left-top point of rect for user-image embeding\r\n            p1: '[610, 679]'  // right-bottom point of rect for user-image embeding\r\n        }\r\n    }\r\n }","export default {\r\n    language:'简体中文',\r\n    title: '给你的头像戴上口罩！',\r\n    logo: {\r\n        filename: 'logo-title-chs.svg',\r\n        height: '25'  // vh\r\n    },\r\n    index: {\r\n        title: {\r\n            text: '疫情当前，有罩才稳',\r\n            letterSpacing: '4px'\r\n        },\r\n        slogan: {\r\n            text1: '给社交网络头像戴上口罩，',\r\n            text2: '提醒更多人关注身体健康。',\r\n            space: '　',\r\n            letterSpacing: '2px'\r\n        },\r\n        selectImg: {\r\n            text: '选择图片',\r\n            width: '160px'\r\n        },\r\n        description: {\r\n            text1: '此页面可以在你的头像上自动P上口罩，你还可以对口罩的位置和大小进行编辑。',\r\n            text2: '人脸检测算法基于SSD MobileNet V1神经网络模型，无需上传图片，也不会保留任何数据。',\r\n            letterSpacing: '1px'\r\n        }\r\n    },\r\n    editor: {\r\n        loading: {\r\n            title: '正在进行人脸检测，请稍等……',\r\n            text1: '由于算法全程在浏览器运行，',\r\n            text2: '运算速度可能取决于设备性能。',\r\n            width: '280px',\r\n            height: '94px'\r\n        },\r\n        reset: {\r\n            text: '重置',\r\n            width: '60px'\r\n        },\r\n        changeMask: '更换口罩',\r\n        reselectImg: {\r\n            text: '重选图片',\r\n            width: '120px'\r\n        },\r\n        saveImg: {\r\n            text: '保存图片',\r\n            width: '120px'\r\n        },\r\n    },\r\n    export: {\r\n        loading: {\r\n            title: '正在导出中……',\r\n            width: '200px',\r\n            height: '50px'\r\n        },\r\n        title: '长按或右键保存下方图片',\r\n        backToEditor: {\r\n            text: '继续编辑',\r\n            width: '120px'\r\n        },\r\n        backToIndex: {\r\n            text: '重选图片',\r\n            width: '120px'\r\n        },\r\n        share: {\r\n            text: '分享',\r\n            width: '60px'\r\n        }\r\n    },\r\n    share: {\r\n        loading: {\r\n            title: '正在生成中……',\r\n            width: '200px',\r\n            height: '50px'\r\n        },\r\n        title: '保存下方图片，分享给朋友吧！',\r\n        back: {\r\n            text: '返回',\r\n            width: '120px'\r\n        },\r\n        shareImg: {\r\n            filename: 'share-github-chs.png',\r\n            p0: '[157, 272]',  // left-top point of rect for user-image embeding\r\n            p1: '[610, 679]'  // right-bottom point of rect for user-image embeding\r\n        }\r\n    }\r\n }","import Vue from 'vue'\r\nimport VueI18n from 'vue-i18n'\r\nimport en from './lang/en'\r\nimport chs from './lang/chs'\r\n\r\nVue.use(VueI18n)\r\nconst i18n = new VueI18n({\r\n  locale: 'chs',\r\n  messages: {\r\n    en,\r\n    chs\r\n  }\r\n})\r\n\r\nexport default i18n","import Vue from 'vue'\nimport App from './App.vue'\nimport store from './store'\nimport i18n from './i18n'\n\nimport faceApiUtil from './utils/faceApiUtil'\nfaceApiUtil.loadModels()\n\nVue.config.productionTip = false\n\nnew Vue({\n  store,\n  i18n,\n  render: h => h(App),\n}).$mount('#app')\n","module.exports = __webpack_public_path__ + \"img/example.bcb76468.png\";","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&id=1b4fae52&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&id=1b4fae52&scoped=true&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Share.vue?vue&type=style&index=0&id=180f5125&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Share.vue?vue&type=style&index=0&id=180f5125&scoped=true&lang=css&\""],"sourceRoot":""}